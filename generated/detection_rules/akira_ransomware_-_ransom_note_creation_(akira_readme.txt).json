{
  "name": "Akira Ransomware - Ransom Note Creation (akira_readme.txt)",
  "description": "Detects the creation of 'akira_readme.txt' files, which serve as ransom notes dropped by Akira ransomware. This is a critical indicator of a successful ransomware attack.",
  "type": "query",
  "query": "event.code:11 AND file.name:akira_readme.txt",
  "language": "lucene",
  "index": [
    "winlogbeat-*",
    "logs-endpoint.events.file-*"
  ],
  "filters": [],
  "risk_score": 90,
  "severity": "critical",
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "id": "TA0040",
        "name": "Impact",
        "reference": "https://attack.mitre.org/tactics/TA0040/"
      },
      "technique": [
        {
          "id": "T1486",
          "name": "Data Encrypted for Impact",
          "reference": "https://attack.mitre.org/techniques/T1486/"
        }
      ]
    }
  ],
  "references": [
    "https://attack.mitre.org/techniques/T1486/",
    "https://www.elastic.co/guide/en/ecs/current/ecs-file.html",
    "https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-query-string-query.html"
  ],
  "author": [
    "Detection Agent"
  ],
  "false_positives": [
    "Extremely unlikely. Investigate any occurrences immediately."
  ],
  "note": "## Triage\nInvestigate: the process responsible for creating the ransom note, the full file path, and the user context. This is a critical alert indicating active ransomware encryption.\nEscalate immediately: This is a confirmed ransomware infection.",
  "test_cases": [
    {
      "type": "TP",
      "description": "Ransom note 'akira_readme.txt' created in user directory",
      "log_entry": {
        "event": {
          "code": 11,
          "provider": "Microsoft-Windows-Sysmon"
        },
        "file": {
          "name": "akira_readme.txt",
          "extension": "txt",
          "path": "C:\\Users\\victim\\Documents\\akira_readme.txt",
          "full_path": "C:\\Users\\victim\\Documents\\akira_readme.txt"
        },
        "process": {
          "name": "akira_ransom.exe",
          "executable": "C:\\ProgramData\\akira_ransom.exe"
        },
        "@timestamp": "2024-03-12T22:35:00Z"
      },
      "expected_match": true,
      "evasion_technique": null
    },
    {
      "type": "TP",
      "description": "Ransom note 'akira_readme.txt' created in a network share",
      "log_entry": {
        "event": {
          "code": 11,
          "provider": "Microsoft-Windows-Sysmon"
        },
        "file": {
          "name": "akira_readme.txt",
          "extension": "txt",
          "path": "\\\\Share\\Data\\akira_readme.txt",
          "full_path": "\\\\Share\\Data\\akira_readme.txt"
        },
        "process": {
          "name": "akira_ransom.exe",
          "executable": "C:\\ProgramData\\akira_ransom.exe"
        },
        "@timestamp": "2024-03-12T22:35:15Z"
      },
      "expected_match": true,
      "evasion_technique": null
    },
    {
      "type": "FN",
      "description": "Ransomware uses a different ransom note filename",
      "log_entry": {
        "event": {
          "code": 11,
          "provider": "Microsoft-Windows-Sysmon"
        },
        "file": {
          "name": "HOW_TO_DECRYPT.txt",
          "extension": "txt",
          "path": "C:\\Users\\victim\\Documents\\HOW_TO_DECRYPT.txt",
          "full_path": "C:\\Users\\victim\\Documents\\HOW_TO_DECRYPT.txt"
        },
        "process": {
          "name": "akira_ransom.exe",
          "executable": "C:\\ProgramData\\akira_ransom.exe"
        },
        "@timestamp": "2024-03-12T22:36:00Z"
      },
      "expected_match": false,
      "evasion_technique": "Ransomware used a different filename for the ransom note, bypassing this specific rule. Requires updating the rule with new filenames."
    },
    {
      "type": "FP",
      "description": "Legitimate file with a similar name (hypothetical)",
      "log_entry": {
        "event": {
          "code": 11,
          "provider": "Microsoft-Windows-Sysmon"
        },
        "file": {
          "name": "akira_project_readme.txt",
          "extension": "txt",
          "path": "C:\\Projects\\Akira\\akira_project_readme.txt",
          "full_path": "C:\\Projects\\Akira\\akira_project_readme.txt"
        },
        "process": {
          "name": "code_editor.exe",
          "executable": "C:\\Program Files\\CodeEditor\\code_editor.exe"
        },
        "@timestamp": "2024-03-14T10:50:00Z"
      },
      "expected_match": false,
      "evasion_technique": null
    },
    {
      "type": "TN",
      "description": "Normal file creation (log file)",
      "log_entry": {
        "event": {
          "code": 11,
          "provider": "Microsoft-Windows-Sysmon"
        },
        "file": {
          "name": "app_log.txt",
          "extension": "txt",
          "path": "C:\\ProgramData\\App\\app_log.txt",
          "full_path": "C:\\ProgramData\\App\\app_log.txt"
        },
        "process": {
          "name": "app.exe",
          "executable": "C:\\Program Files\\App\\app.exe"
        },
        "@timestamp": "2024-03-14T10:55:00Z"
      },
      "expected_match": false,
      "evasion_technique": null
    }
  ]
}