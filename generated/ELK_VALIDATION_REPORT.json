{
  "timestamp": "2026-02-08T03:12:21.214729",
  "total_rules": 3,
  "successful_conversions": 3,
  "approved_queries": 0,
  "rejected_queries": 3,
  "validations": [
    {
      "valid": false,
      "overall_score": 0.0,
      "decision": "REJECT",
      "issues": [
        "Failed to parse LLM validation response"
      ],
      "error": "Unterminated string starting at: line 20 column 5 (char 1864)",
      "rule_id": "c1a7b8d9-0f1e-4d2c-8a3b-4e5f6a7b8c9d",
      "rule_title": "Akira Ransomware: Ransom Note Creation"
    },
    {
      "valid": false,
      "overall_score": 0.0,
      "decision": "REJECT",
      "issues": [
        "Failed to parse LLM validation response"
      ],
      "error": "Unterminated string starting at: line 19 column 5 (char 1688)",
      "rule_id": "f8a0b3c1-1e9d-4c5b-9a8f-2e3d7a6b4c10",
      "rule_title": "Akira Ransomware Note Creation"
    },
    {
      "valid": true,
      "syntax_score": 1.0,
      "field_mapping_score": 0.7,
      "logic_accuracy_score": 1.0,
      "performance_score": 0.2,
      "overall_score": 0.725,
      "issues": [
        "Critical performance issue: The query uses leading wildcards (`*`) in `TargetFilename:*.akira` and `Image:*\\\\...`. This will result in very slow query performance as it requires scanning all terms in the index for these fields. [1, 10, 15]"
      ],
      "warnings": [
        "Field names `TargetFilename` and `Image` are not ECS (Elastic Common Schema) compliant. The recommended ECS equivalents are `file.name` and `process.executable`, respectively. [5, 11, 12] Verify these fields exist in the target index mapping.",
        "The `query_string` query is used, which can have complex and sometimes unexpected parsing behavior. [2, 18] A structured `bool` query with specific `wildcard` clauses would be more explicit and less prone to parsing errors."
      ],
      "recommendations": [
        "To improve query clarity and structure, rewrite the query using a `bool` query with `must` and `must_not` clauses containing explicit `wildcard` queries.",
        "For significantly better performance, avoid leading wildcards. If 'endswith' functionality is essential, consider architectural changes during data ingestion, such as indexing a reversed version of the field values to allow for efficient prefix-based searches. [1, 10]",
        "When using wildcard or other string-based queries, ensure they target a non-analyzed `keyword` field (e.g., `Image.keyword`) to prevent unexpected behavior from text analysis. [16]"
      ],
      "decision": "REJECT",
      "rule_id": "d4e6f1a8-3b9c-4d5e-9f0a-1b2c3d4e5f6a",
      "rule_title": "Akira Ransomware: File Encryption Activity"
    }
  ]
}